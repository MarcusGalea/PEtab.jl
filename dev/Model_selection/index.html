<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model selection (PEtab select) · PEtab.jl</title><meta name="title" content="Model selection (PEtab select) · PEtab.jl"/><meta property="og:title" content="Model selection (PEtab select) · PEtab.jl"/><meta property="twitter:title" content="Model selection (PEtab select) · PEtab.jl"/><meta name="description" content="Documentation for PEtab.jl."/><meta property="og:description" content="Documentation for PEtab.jl."/><meta property="twitter:description" content="Documentation for PEtab.jl."/><meta property="og:url" content="https://sebapersson.github.io/PEtab.jl/Model_selection/"/><meta property="twitter:url" content="https://sebapersson.github.io/PEtab.jl/Model_selection/"/><link rel="canonical" href="https://sebapersson.github.io/PEtab.jl/Model_selection/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PEtab.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Boehm/">Importing a PEtab problem</a></li><li><span class="tocitem">Defining a PEtab problem in Julia</span><ul><li><a class="tocitem" href="../Define_in_julia/">Getting started</a></li><li><a class="tocitem" href="../Julia_steady_state/">Pre-equilibration (steady-state simulations)</a></li><li><a class="tocitem" href="../Julia_obs_noise/">Noise and observable parameters</a></li><li><a class="tocitem" href="../Julia_condition_specific/">Condition specific system/model parameters</a></li><li><a class="tocitem" href="../Julia_event/">Events (callbacks, dosages etc...)</a></li></ul></li><li><span class="tocitem">Selecting options for a PEtab-problem</span><ul><li><a class="tocitem" href="../Brannmark/">Models with pre-equilibration (steady-state simulation)</a></li><li><a class="tocitem" href="../Bachmann/">Medium sized models and adjoint sensitivity analysis</a></li><li><a class="tocitem" href="../Beer/">Models with many conditions specific parameters</a></li></ul></li><li><span class="tocitem">Parameter estimation</span><ul><li><a class="tocitem" href="../Parameter_estimation/">Parameter estimation</a></li><li><a class="tocitem" href="../Avaible_optimisers/">Available optimisers</a></li><li class="is-active"><a class="tocitem" href>Model selection (PEtab select)</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../optimisation_output_plotting/">Plots evaluating parameter estimation</a></li></ul></li><li><a class="tocitem" href="../Gradient_hessian_support/">Supported gradient and hessian methods</a></li><li><a class="tocitem" href="../Best_options/">Choosing the best options for a PEtab problem</a></li><li><a class="tocitem" href="../API_choosen/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Parameter estimation</a></li><li class="is-active"><a href>Model selection (PEtab select)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model selection (PEtab select)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sebapersson/PEtab.jl/blob/main/docs/src/Model_selection.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-selection-with-PEtab-Select"><a class="docs-heading-anchor" href="#Model-selection-with-PEtab-Select">Model selection with PEtab Select</a><a id="Model-selection-with-PEtab-Select-1"></a><a class="docs-heading-anchor-permalink" href="#Model-selection-with-PEtab-Select" title="Permalink"></a></h1><p>In many scenarios we have competing hypotheses (model structures) that we want to compare. For model selection, various approaches like forward search, backward search, and exhaustive search using evaluation criteria such as AIC are commonly used. These methods are supported by <a href="https://github.com/PEtab-dev/petab_select">PEtab Select</a>, a tool designed for model selection.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To use the parameter estimation functionality Optim, QuasiMonteCarlo and PyCall must be loaded (see examples below).</p></div></div><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>PEtab.jl provides support for PEtab Select through the <code>run_PEtab_select</code> function. This function takes two required arguments; the path to the PEtab Select YAML file, and the optimizer for parameter estimation. For the optimizer, you can choose from <code>optimizer=Fides()</code> (Fides Newton-trust region), <code>optimizer=IPNewton()</code> from Optim.jl, or <code>optimizer=LBFGS()</code> from Optim.jl (<a href="../Parameter_estimation/#parameter_estimation">see</a>). Additionally, you can pass any keyword arguments accepted by the <code>calibrate_model</code> function for parameter estimation and <code>PEtabODEProblem</code> function for setting simulation options (<a href="../Gradient_hessian_support/#gradient_support">see</a>).</p><p>Since PEtab Select is a Python package, you need to have <a href="https://github.com/JuliaPy/PyCall.jl">PyCall.jl</a> installed. Before using it, build PyCall with a Python environment that has PEtab select installed. Here&#39;s an example of how to do it (note that <code>path_python_exe</code> depends on your system configuration):</p><pre><code class="language-julia hljs">using PyCall
path_python_exe = joinpath(&quot;/&quot;, &quot;home&quot;, &quot;sebpe&quot;, &quot;anaconda3&quot;, &quot;envs&quot;, &quot;PeTab&quot;, &quot;bin&quot;, &quot;python&quot;)
ENV[&quot;PYTHON&quot;] = path_python_exe
import Pkg; Pkg.build(&quot;PyCall&quot;)</code></pre><p>Once you have a correctly encoded PEtab Select problem (see the <a href="https://github.com/PEtab-dev/petab_select">guide</a> for details), you can run PEtab Select using the <code>IPNewton()</code> optimizer with the following code:</p><pre><code class="language-julia hljs">using PEtab 
using OrdinaryDiffEq
using Optim
using QuasiMonteCarlo

path_yaml = joinpath(@__DIR__, &quot;PEtab_select&quot;, &quot;0002&quot;, &quot;petab_select_problem.yaml&quot;)
path_save = run_PEtab_select(path_yaml, IPNewton(), 
                          nOptimisationStarts=10, 
                          ode_solver=ODESolver(Rodas5P()),
                          gradient_method=:ForwardDiff, 
                          hessian_method=:ForwardDiff)</code></pre><pre><code class="nohighlight hljs">┌ Info: PEtab select problem info
│ Method: forward
└ Criterion: AIC
[ Info: Model selection round 1 with 1 candidates - as the code compiles in this round compiled it takes extra long time https://xkcd.com/303/
[ Info: Callibrating model M1_0
[ Info: Model selection round 2 with 3 candidates
[ Info: Callibrating model M1_1
[ Info: Callibrating model M1_2
[ Info: Callibrating model M1_3
[ Info: Model selection round 3 with 2 candidates
[ Info: Callibrating model M1_5
[ Info: Callibrating model M1_6
[ Info: Model selection round 4 with 1 candidates
[ Info: Callibrating model M1_7
[ Info: Saving results for best model at 0002/PEtab_select_forward_AIC.yaml</code></pre><p>The YAML file storing the model selection results will be saved at <code>path_save</code>.</p><p>To run the code, you will need the PEtab files, which you can find <a href="https://github.com/sebapersson/PEtab.jl/tree/main/examples/0002">here</a>. You can also find a fully runnable example of this tutorial <a href="https://github.com/sebapersson/PEtab.jl/tree/main/examples/PEtab_select.jl">here</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Avaible_optimisers/">« Available optimisers</a><a class="docs-footer-nextpage" href="../optimisation_output_plotting/">Plots evaluating parameter estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 28 November 2023 15:14">Tuesday 28 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
