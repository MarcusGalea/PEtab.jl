<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model selection (PEtab select) · PEtab.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://sebapersson.github.io/PEtab.jl/Model_selection/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PEtab.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Boehm/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../Brannmark/">Models with pre-equilibration (steady-state simulation)</a></li><li><a class="tocitem" href="../Bachmann/">Medium sized models and adjoint sensitivity analysis</a></li><li><a class="tocitem" href="../Beer/">Models with many conditions specific parameters</a></li><li><a class="tocitem" href="../Beer_julia_import/">Providing the model as a Julia file instead of an SBML File</a></li><li><a class="tocitem" href="../Parameter_estimation/">Parameter estimation</a></li><li class="is-active"><a class="tocitem" href>Model selection (PEtab select)</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../Gradient_hessian_support/">Supported gradient and hessian methods</a></li><li><a class="tocitem" href="../Best_options/">Choosing the best options for a PEtab problem</a></li><li><a class="tocitem" href="../API_choosen/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Model selection (PEtab select)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model selection (PEtab select)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sebapersson/PEtab.jl/blob/main/docs/src/Model_selection.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-selection-with-PEtab-Select"><a class="docs-heading-anchor" href="#Model-selection-with-PEtab-Select">Model selection with PEtab Select</a><a id="Model-selection-with-PEtab-Select-1"></a><a class="docs-heading-anchor-permalink" href="#Model-selection-with-PEtab-Select" title="Permalink"></a></h1><p>In many scenarios we have competing hypotheses (model structures) that we want to compare. For model selection, various approaches like forward search, backward search, and exhaustive search using evaluation criteria such as AIC are commonly used. These methods are supported by <a href="https://github.com/PEtab-dev/petab_select">PEtab Select</a>, a tool designed for model selection.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To use the parameter estimation functionality Optim, QuasiMonteCarlo and PyCall must be loaded (see examples below).</p></div></div><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>PEtab.jl provides support for PEtab Select through the <code>runPEtabSelect</code> function. This function takes two required arguments; the path to the PEtab Select YAML file, and the optimizer for parameter estimation. For the optimizer, you can choose from <code>optimizer=Fides()</code> (Fides Newton-trust region), <code>optimizer=IPNewton()</code> from Optim.jl, or <code>optimizer=LBFGS()</code> from Optim.jl (<a href="../Parameter_estimation/#parameter_estimation">see</a>). Additionally, you can pass any keyword arguments accepted by the <code>calibrateModel</code> function for parameter estimation and <code>createPEtabODEProblem</code> function for setting simulation options (<a href="../Gradient_hessian_support/#gradient_support">see</a>).</p><p>Since PEtab Select is a Python package, you need to have <a href="https://github.com/JuliaPy/PyCall.jl">PyCall.jl</a> installed. Before using it, build PyCall with a Python environment that has PEtab select installed. Here&#39;s an example of how to do it (note that <code>pathToPythonExe</code> depends on your system configuration):</p><pre><code class="language-julia hljs">using PyCall
pathToPythonExe = joinpath(&quot;/&quot;, &quot;home&quot;, &quot;sebpe&quot;, &quot;anaconda3&quot;, &quot;envs&quot;, &quot;PeTab&quot;, &quot;bin&quot;, &quot;python&quot;)
ENV[&quot;PYTHON&quot;] = pathToPythonExe
import Pkg; Pkg.build(&quot;PyCall&quot;)</code></pre><p>Once you have a correctly encoded PEtab Select problem (see the <a href="https://github.com/PEtab-dev/petab_select">guide</a> for details), you can run PEtab Select using the <code>IPNewton()</code> optimizer with the following code:</p><pre><code class="language-julia hljs">using PEtab 
using OrdinaryDiffEq
using Optim
using QuasiMonteCarlo

pathYAML = joinpath(@__DIR__, &quot;PEtab_select&quot;, &quot;0002&quot;, &quot;petab_select_problem.yaml&quot;)
pathSave = runPEtabSelect(pathYAML, IPNewton(), 
                          nOptimisationStarts=10, 
                          odeSolverOptions=ODESolverOptions(Rodas5P()),
                          gradientMethod=:ForwardDiff, 
                          hessianMethod=:ForwardDiff)</code></pre><pre><code class="nohighlight hljs">┌ Info: PEtab select problem info
│ Method: forward
└ Criterion: AIC
[ Info: Model selection round 1 with 1 candidates - as the code compiles in this round compiled it takes extra long time https://xkcd.com/303/
[ Info: Callibrating model M1_0
[ Info: Model selection round 2 with 3 candidates
[ Info: Callibrating model M1_1
[ Info: Callibrating model M1_2
[ Info: Callibrating model M1_3
[ Info: Model selection round 3 with 2 candidates
[ Info: Callibrating model M1_5
[ Info: Callibrating model M1_6
[ Info: Model selection round 4 with 1 candidates
[ Info: Callibrating model M1_7
[ Info: Saving results for best model at 0002/PEtab_select_forward_AIC.yaml</code></pre><p>The YAML file storing the model selection results will be saved at <code>pathSave</code>.</p><p>To run the code, you will need the PEtab files, which you can find <a href="https://github.com/sebapersson/PEtab.jl/tree/main/examples/0002">here</a>. You can also find a fully runnable example of this tutorial <a href="https://github.com/sebapersson/PEtab.jl/tree/main/examples/PEtab_select.jl">here</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Parameter_estimation/">« Parameter estimation</a><a class="docs-footer-nextpage" href="../Gradient_hessian_support/">Supported gradient and hessian methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 31 August 2023 07:50">Thursday 31 August 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
